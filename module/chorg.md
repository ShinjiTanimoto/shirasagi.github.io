---
layout: default
title: 組織変更
---

組織の改編をサポートする機能です。
次の手順で使用します。

1. 変更情報の登録
2. テスト実行
3. 本番実行
4. 実行後の確認

## 変更情報の登録

変更情報として、次の 5 種類の情報を登録します。

### 新設

  * 新規に追加するグループを登録します。
  * 既にグループが存在する場合は、登録情報で上書きされます。

### 移動

  * グループの移動情報を登録します。
  * 既存のグループ名/電話番号/FAX番号/email を変更します（グループの ID は変わりません）。
  * 移動元グループに所属するユーザは、新しいグループに移動します。
  * 記事、フォルダー、パーツ、レイアウトのプロパティに、移動元グループの情報が設定されている場合、移動先のグループ情報に置き換わります。

### 統合

  * 2 つ以上のグループが 1 つに統合される場合、統合情報を登録します。
  * 統合先グループを新規作成します。統合先グループが存在する場合は、登録情報で上書きされます。
  * 統合元グループを削除します。
  * 統合元グループに所属しているユーザは、統合先グループに移動します。
  * 記事、フォルダー、パーツ、レイアウトのプロパティに、統合元グループの情報が設定されている場合、統合先のグループ情報に置き換わります。

### 分割

  * 1 つのグループが 2 つ以上に分割される場合、分割情報を登録します。
  * 分割先グループを新規作成します。分割先グループが存在する場合は、登録情報で上書きされます。
  * 分割元グループを削除します。
  * 分割元グループに所属しているユーザは、1 番目の分割先のグループに所属します。
  * 記事、フォルダー、パーツ、レイアウトのプロパティに、分割元グループの情報が設定されている場合、1 番目の分割先のグループ情報に置き変わります。
  * 記事、フォルダー、パーツ、レイアウトの所有権は、全ての分割先グループを割り当てます。
  * 実行後、
    * ユーザを適切に振り分けてください。
    * 記事、フォルダー、パーツ、レイアウトのプロパティを適切に設定しなおしてください。
    * 記事、フォルダー、パーツ、レイアウトの所有権を適切に振り分けてください。

### 廃止

  * グループが廃止される場合、廃止情報を登録します。
  * 廃止グループを削除します。
  * 実行後
    * 廃止グループに所属するユーザを適切に振り分けてください。
    * 記事、フォルダー、パーツ、レイアウトのプロパティを適切に設定しなおしてください。
    * 記事、フォルダー、パーツ、レイアウトの所有権を適切に振り分けてください。

## テスト実行

テスト実行では、組織変更をシミュレートすることが出来ます。テストの実行結果をログファイルという形で閲覧することが出来ます。

## 本番実行

本番実行では、組織変更を実行します。

## 実行後の確認

* 分割情報や廃止情報を登録した場合、本番実行後にユーザ、記事、フォルダ、パーツ、レイアウトを適切に修正する必要があります。
* 記事の添付ファイル、アップロードしたファイルなどは自動で新しいグループ情報に置換されません。実行後に確認をお願いします。

## システム設定

`config/chorg.yml` でシステムの設定を変更することが出来ます。

* max_division: 最大分割数で、既定では 3 になっています。4 グループ以上に分割したい場合、変更する必要があります。
